---
title: "Jordan V. Lebron"
author: "Xiang Jiang and Albion Shoshi"
date: "April 5, 2024"
output: pdf_document
geometry: left=0.5in,right=0.5in,top=0.5in,bottom=0.5in
urlcolor: blue
---

```{r setupFiles, include = FALSE}
# This template file is based off of a template created by Alex Hayes
# https://github.com/alexpghayes/rmarkdown_homework_template

# Setting Document Options
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.align = "center"
)
```

```{r}
# Import libraries and data here
library(dplyr)
library(readr)
library(tidyverse)
library(rvest)
library(ggplot2)
library(tidyr)
library(esquisse)
```

```{r}
# Downloaded Lebron Data from BasketBall Reference
# Link: https://www.basketball-reference.com/players/j/jamesle01.html#per_game
LebronPerGame <- read_csv('/Users/xiangjiang/Desktop/LebronNew/LebronPerGameNew.csv')
LebronTotals <- read_csv('/Users/xiangjiang/Desktop/LebronNew/LebronTotalStatsNew.csv')
LebronAdvanced <- read_csv('/Users/xiangjiang/Desktop/LebronNew/LebronAdvancedNew.csv')
LebronPer100Poss <- read_csv('/Users/xiangjiang/Desktop/LebronNew/LebronPer100Poss.csv')
LebronAllStarGames <- read_csv('/Users/xiangjiang/Desktop/LebronNew/LebronAllStarGame.csv')

# Downloaded Jordan Data from BasketBall Reference
# Link: https://www.basketball-reference.com/players/j/jordami01.html
JordanPerGame <- read_csv('/Users/xiangjiang/Desktop/JordanNew/JordanPerGameNew.csv')
JordanTotals <- read_csv('/Users/xiangjiang/Desktop/JordanNew/JordanTotalStatsNew.csv')
JordanAdvanced <- read_csv('/Users/xiangjiang/Desktop/JordanNew/JordanAdvancedNew.csv')
JordanPer100Poss <- read_csv('/Users/xiangjiang/Desktop/JordanNew/JordanPer100Poss.csv')
JordanAllStarGames <- read_csv('/Users/xiangjiang/Desktop/JordanNew/JordanAllStarGame.csv')
```
# Guiding Question: 
* Who is the Greatest Basketball Player of All Time in NBA History, Lebron or Jordan?

# Become acquainted with your data sources:
## Where did you find them?
* Data retrieved from BasketBall Reference.

## Who collected/maintains them?
* Sean Lahman donated much of the initial data.
* Chip Hart and Kevin Cohen provided input on the site's design and data collection, respectively.
* Tom Timmerman, Dick Pfander, Todd Spehr, Matt Shuh, Justin Kubatko, Sean Burrill, Tariq Jabbar, Mike Lynch, Michael Hamel, Mark Montieth, and Robert Bradley have all contributed significantly to the collection of NBA and ABA data.
* Matthew Maurer, an NBA Draft historian, has supplied information on the NBA Draft.

## When & Why were they originally collected?
Basketball Reference was launched in April of 2004 by Justin Kubatko. The primary goal was to create a comprehensive database that tracks basketball information. This encompasses player statistics, team performances, game results, and much more, making it an invaluable resource for fans, analysts, and researchers interested in the sport's history and current events.

## What does a case represent in each data source, and how many total cases are available?
* For player statistics, each row or case represents a season's worth of performance data for that player.
* Game logs would treat each game as a case.
* Draft data entries represent individual players selected in the NBA draft.
* There are thousands of cases covering decades of basketball history across the NBA and ABA.

## What are some of the variables that you plan to use?
* Points per game (PointsPerGame)
* Assists per game (AssistsPerGame) 
* Rebounds per game (ReboundsPerGame)
* Total Points (TotalPoints)
* Total Assists (TotalAssists)
* Total Rebounds (TotalRebounds)
* Player efficiency rating (PlayerEfficiencyRating)
* Career achievements (CareerAchievements)
* All-star game appearances (AllStarGameAppearances)
* Game scores (GameScores)

# Explore intuition related to the research question

# 1. Comparing Lebron and Jordans total and per-game stats

## Bargraph showcasing a comparison of per game-stats
```{r}
LebronStatsPerGame <- LebronTotals %>%
  summarise(Player = "Lebron James", AssistsPerGame = sum(AST, na.rm = TRUE) / sum(G, na.rm = TRUE), ReboundsPerGame = sum(TRB, na.rm = TRUE) / sum(G, na.rm = TRUE), PointsPerGame = sum(PTS, na.rm = TRUE) / sum(G, na.rm = TRUE))

JordanStatsPerGame <- JordanTotals %>%
  summarise(Player = "Michael Jordan", AssistsPerGame = sum(AST, na.rm = TRUE) / sum(G, na.rm = TRUE), ReboundsPerGame = sum(TRB, na.rm = TRUE) / sum(G, na.rm = TRUE), PointsPerGame = sum(PTS, na.rm = TRUE) / sum(G, na.rm = TRUE))

StatsComparison <- bind_rows(LebronStatsPerGame, JordanStatsPerGame)

StatsComparisonLong <- StatsComparison %>%
  pivot_longer(cols = c(AssistsPerGame, ReboundsPerGame, PointsPerGame), names_to = "Statistic", values_to = "Value")

ggplot(StatsComparisonLong, aes(x = Statistic, y = Value, fill = Player)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
  theme_minimal() +
  labs(title = "Comparison of Per Game Statistics", subtitle = "Lebron James vs. Michael Jordan", x = "Category", y = "Per Game Average", fill = "Player") +
  scale_fill_manual(values = c("Lebron James" = "purple", "Michael Jordan" = "blue")) +
  theme(text = element_text(size = 12))

print(StatsComparison)
```
LeBron has averaged 27.1 points, 7.4 assists, and 7.5 rebounds per game over the course of his 21 year career. Jordan has averaged 30.1 points, 5.3 assists, and 6.2 rebounds over the course of his 15 year career. Even though Jordan has averaged a higher amount of points, LeBron was never seen as a scorer. LeBron was known for his playmaking and getting his team involved (We can see that with the 7.4 assists), while Jordan was predominantly known as a prolific scorer.

## Bargraph showcasing a comparison of total stats

```{r}
LebronTotalsStats <- LebronTotals %>%
  summarise(Player = "Lebron James", TotalRebounds = sum(TRB, na.rm = TRUE), TotalAssists = sum(AST, na.rm = TRUE), TotalPoints = sum(PTS, na.rm = TRUE))

JordanTotalsStats <- JordanTotals %>%
  summarise(Player = "Michael Jordan", TotalRebounds = sum(TRB, na.rm = TRUE), TotalAssists = sum(AST, na.rm = TRUE), TotalPoints = sum(PTS, na.rm = TRUE))

StatsComparison <- bind_rows(LebronTotalsStats, JordanTotalsStats)

StatsComparisonLong <- StatsComparison %>%
  pivot_longer(cols = c(TotalRebounds, TotalAssists, TotalPoints), names_to = "Statistic", values_to = "Value")

ggplot(StatsComparisonLong, aes(x = Statistic, y = Value, fill = Player)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
  theme_minimal() +
  labs(title = "Comparison of Total Game Statistics", subtitle = "Lebron James vs. Michael Jordan", x = "Category", y = "Per Game Average", fill = "Player") +
  scale_fill_manual(values = c("Lebron James" = "purple", "Michael Jordan" = "blue")) +
  theme(text = element_text(size = 12))

print(StatsComparison)
```
LeBron over the course of his 21 years has accumulated 40,474 points, 11,009 assists, and 11,185 total rebounds. Jordan in his 15 years in the league has totaled 32,292 points, 5,633 assists, and 6,672 total rebounds. LeBron has just overtaken Kareem as the all time leading scorer and sits in 4th place for total all time assists while Jordan barely breaks the top five for points and has nowhere near the rebounds and assists to be a leader in the stat. Even though LeBron has played 6 more seasons than Jordan, he is currently putting up 27 points per game for his entire career including this current year at 39 years old. Jordan had to retire at 39 because he was such a liability as a player.


# 2. Using Advanced and Per100Poss stats for comparison

## Dotplot showcasing VORP (Value over replacement player)
```{r}
LebronLongevity <- LebronAdvanced %>%
  mutate(PlayerName = "Lebron James", Games = G, TrueShootingPercentage = as.numeric("TS%"), WinShare = WS, ValueOverReplacementPlayer = VORP, na.rm = TRUE) %>%
  select(PlayerName, Season, Games, TrueShootingPercentage, WinShare, ValueOverReplacementPlayer)

JordanLongevity <- JordanAdvanced %>%
  mutate(PlayerName = "Michael Jordan", Games = G, TrueShootingPercentage = as.numeric("TS%"), WinShare = WS, ValueOverReplacementPlayer = VORP, na.rm = TRUE) %>%
  select(PlayerName, Season, Games, TrueShootingPercentage, WinShare, ValueOverReplacementPlayer)

CombinedData <- bind_rows(LebronLongevity, JordanLongevity)

CombinedDataLonger <- CombinedData %>%
  pivot_longer(cols = c(Games), names_to = "Statistic", values_to = "Value")

CombinedDataLonger %>%
  ggplot(aes(x = ValueOverReplacementPlayer, y = Value, color = PlayerName)) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  theme_minimal() +
  facet_wrap(vars(PlayerName)) + 
  labs(title = "Effeciency using (VORP)", subtitle = "Lebron James vs. Michael Jordan", x = "Category", y = "Value", fill = "Player")
```
This bar plot shows an advanced stat, Value over replacement player. This is showing us per 100 possessions each players had accounted for that benefited their team. We can see that Jordans ceiling is higher and has had more instances in his career where his VORP is higher than LeBrons. We can also see that LeBron is way more consistent with his lowest points on the bar plot accounting for his rookie seasons in the NBA when he was 18 coming out of high school. This plot leans both ways with what bias you hold towards either player, but overall we think this shows how valuable LeBron really is to his team.

## Bargraph showcasing Player Effeciency Ratings (PER)

```{r}
PER <- function(x){
  x %>%
    mutate(uPER = (PTS + TRB + AST + STL + BLK - ((FGA - FG) + (FTA - FT) + TOV)) / G) %>%
    summarise(AveragePER = mean(uPER, na.rm = TRUE))
}

LebronPER <- PER(LebronTotals) %>%
  mutate(Player = "Lebron James")

JordanPER <- PER(JordanTotals) %>%
  mutate(Player = "Michael Jordan")

PERComparison <- bind_rows(LebronPER, JordanPER)

print(PERComparison)

ggplot(PERComparison, aes(x = Player, y = AveragePER, fill = Player)) +
  geom_bar(stat = "identity", position = position_dodge(), width = 0.5) +
  theme_minimal() +
  labs(title = "Comparison of Estimated Player Efficiency Rating (PER)", subtitle = "LeBron James vs. Michael Jordan", y = "Estimated Average PER", fill = "Player") +
  scale_fill_manual(values = c("Lebron James" = "purple", "Michael Jordan" = "blue")) +
  theme(text = element_text(size = 12))
```
This graph compares LeBron and Jordans efficiency ratings over the course of their careers when comparing their turnover percentages to their scoring ability. The graph shows that Lebrons per 100 possesions stats makes LeBron a more efficient player.

# 3. Showcasing and comparing LeBron and Jordans Legacys

## Barpgraph that shows LeBron and Jordans Effeciency ratings above age 30
```{r}
OldBron <- LebronPer100Poss %>%
  filter(Season > "2014-15") %>%
  mutate(PER = (PTS + TRB + AST + STL + BLK - ((FGA - FG) + (FTA - FT) + TOV)) / G) %>%
  mutate(Player = "Lebron James")

OldJordan <-  JordanPer100Poss%>%
  filter(Season > "1994-95")  %>%
  mutate(PER = (PTS + TRB + AST + STL + BLK - ((FGA - FG) + (FTA - FT) + TOV)) / G) %>%
  mutate(Player = "Michael Jordan")

OldComp <- bind_rows(OldBron, OldJordan)

print(OldComp)

ggplot(OldComp, aes(x = Player, y = PER, fill = Player)) +
  geom_bar(stat = "identity", position = position_dodge(), width = 0.5) +
  theme_minimal() +
  labs(title = "Efficiency per 100 possesions at age 30 plus", subtitle = "LeBron James vs. Michael Jordan", y = "Average efficiency per 100 possesions", fill = "Player") +
  scale_fill_manual(values = c("Lebron James" = "purple", "Michael Jordan" = "blue")) +
  theme(text = element_text(size = 12))
```
This bar graph compares Michael Jordan and LeBrons efficiency's per 100 possessions at age 30 plus. We can clearly see the longevity LeBron holds. When comparing points, assists, rebounds,field goal percentages, and turnover rate, we see that LeBron dominates. At age 39 LeBron is still considered a top player in the NBA while Jordan was a dwindling old man expiring in his puny body.

## Comparing total all star appearences

```{r}
LebronAllStarAppearances <- nrow(LebronAllStarGames)
JordanAllStarAppearances <- nrow(JordanAllStarGames)

print(paste("Lebron James All-Star Game Appearances:", LebronAllStarAppearances))
print(paste("Michael Jordan All-Star Game Appearances:", JordanAllStarAppearances))

AllStarData <- data.frame(Player = c("Lebron James", "Michael Jordan"), Appearances = c(LebronAllStarAppearances, JordanAllStarAppearances))

ggplot(AllStarData, aes(x = Player, y = Appearances, fill = Player)) +
  geom_bar(stat = "identity", position = position_dodge(), width = 0.5) +
  theme_minimal() +
  labs(title = "All-Star Game Appearances", y = "Number of Appearances", fill = "Player") +
  scale_fill_manual(values = c("Lebron James" = "purple", "Michael Jordan" = "blue"))
```
```

When it comes to All-Star game appearences Lebron has been slected to one every season he has played in the NBA and sits at the most all-star selections ever. Jordans 15, although impressive, are expected when you are considered one of the greatest of all time. Lebrons Longevity to be able to make it to an all star game 21 years, even at his current age of 39 is unheard of.








